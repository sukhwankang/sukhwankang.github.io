---
layout: post
title: UVM Practice (1) Adder Verification
date: 2025-01-08
description: UVM Practice
tags: UVM SystemVerilog Verification
categories: sample-posts
featured: true
---

UVM Verification
I fetched the example code, made some modifications, and executed the simulation on [EDA Playground](https://edaplayground.com).

### Block diagram


<div class="row mt-3">
  <div class="col-sm mt-3 mt-md-0">
    {% include figure.liquid loading="eager" path="assets/blogimg/uvmpractice/1/uvmpractice1_bd.PNG" class="img-fluid rounded z-depth-1" zoomable=true %}
  </div>
</div>
<div class="caption">
  Blockdiagram
</div>



### Class env

```verilog
class env extends uvm_env;

  virtual adder_if m_if;

  function new(string name, uvm_component parent = null);
    super.new(name, parent);
  endfunction
  
  function void connect_phase(uvm_phase phase);
    `uvm_info("INFO", "Started connect phase.", UVM_HIGH);
    // Get the interface from the resource database.
    assert(uvm_resource_db#(virtual adder_if)::read_by_name(get_full_name(), "adder_if", m_if));
    `uvm_info("INFO", "Finished connect phase.", UVM_HIGH);
  endfunction: connect_phase

  task run_phase(uvm_phase phase);
    phase.raise_objection(this);
    `uvm_info("INFO", "Started run phase.", UVM_HIGH);
    
    begin
      int a = 8'd1, b = 8'd2;
      parameter int LOOP_COUNT = 10;
      `uvm_info("INFO", "Start ADDER Check", UVM_HIGH);
      for(int i=0;i<LOOP_COUNT;i++) begin
        @(m_if.cb);
        m_if.cb.a <= a;
        m_if.cb.b <= b;
        #100;
        m_if.cb.en <= 1'b1; //Enable
        //#100;
        repeat(2) @(m_if.cb);
        `uvm_info("RESULT", $sformatf("a=%0d b=%0d -> Sum=%0d", 
         a, b, m_if.cb.sum), UVM_LOW);
        //assert checking the result
        assert(m_if.cb.sum == (a + b))
          else `uvm_error("ERROR", $sformatf("Result Error! Result=%0d, not %0d", m_if.cb.sum, a+b));
        a = a + 1;
        b = b + 1;
        `uvm_info("CHANGE", $sformatf("a=%0d, b=%0d", a, b), UVM_LOW);
      end
      `uvm_info("INFO", "Finished ADDER Check", UVM_HIGH);      
    end
    #400;
    phase.drop_objection(this);
  endtask: run_phase
endclass
```

### Adder and Interface

```verilog
//8-bit Adder
module ADDER(
  input bit              clk,
  input logic [7:0]      a0,
  input logic [7:0]      b0,
  // if this is 1, add; else subtract
  input logic           enable,
  output reg [8:0] sum0
);

  always @ (posedge clk)
    begin
      if (enable)
        sum0 <= a0 + b0;
      else
        sum0 <= 8'hx;
    end

endmodule: ADDER

// Interface
interface adder_if(
  input bit clk,
  input [7:0] a,
  input [7:0] b,
  input       en,
  input [8:0] sum
);

  clocking cb @(posedge clk);
    output    a;
    output    b;
    output    en;
    input     sum;
  endclocking // clocking block

endinterface: adder_if

bind ADDER adder_if adder_if0(
  .clk(clk),
  .a(a0),
  .b(b0),
  .en(enable),
  .sum(sum0)
);
```

### Testbench

```verilog
import uvm_pkg::*;
`include "uvm_macros.svh"
`include "env.sv"

//Top
module top;

  bit clk;
  env environment;
  ADDER dut(.clk (clk));

  initial begin
    environment = new("env");
    // Put the interface into the resource database.
    uvm_resource_db#(virtual adder_if)::set("env",
      "adder_if", dut.adder_if0);
    clk = 0;
    run_test();
  end
  
  initial begin
    forever begin
      #(50) clk = ~clk;
    end
  end
  
  initial begin
    // Dump waves
    $dumpvars(0, top);
  end
  
endmodule
```

### Option
+UVM_VERBOSITY=UVM_HIGH +access+r

### Result Waveform

<div class="row mt-3">
    <div class="col-sm mt-3 mt-md-0">
        {% include figure.liquid loading="eager" path="assets/blogimg/uvmpractice/1/uvmpractice1_1.PNG" class="img-fluid rounded z-depth-1" zoomable=true %}
    </div>
</div>
<div class="caption">
    Result waveform
</div>

### UVM Logs

<div class="row mt-3">
    <div class="col-sm mt-3 mt-md-0">
        {% include figure.liquid loading="eager" path="assets/blogimg/uvmpractice/1/uvmpractice1_2.PNG" class="img-fluid rounded z-depth-1" zoomable=true %}
    </div>
      <div class="col-sm mt-3 mt-md-0">
        {% include figure.liquid loading="eager" path="assets/blogimg/uvmpractice/1/uvmpractice1_3.PNG" class="img-fluid rounded z-depth-1" zoomable=true %}
    </div>
      <div class="col-sm mt-3 mt-md-0">
        {% include figure.liquid loading="eager" path="assets/blogimg/uvmpractice/1/uvmpractice1_4.PNG" class="img-fluid rounded z-depth-1" zoomable=true %}
    </div>
      <div class="col-sm mt-3 mt-md-0">
        {% include figure.liquid loading="eager" path="assets/blogimg/uvmpractice/1/uvmpractice1_5.PNG" class="img-fluid rounded z-depth-1" zoomable=true %}
    </div>
</div>
<div class="caption">
    UVM Logs
</div>


You must indent your code by **(3 \* bullet_indent_level)** spaces. This is because kramdown (the markdown engine used by Jekyll) indentation for the code block in lists is determined by the column number of the first non-space character after the list item marker. For example:

